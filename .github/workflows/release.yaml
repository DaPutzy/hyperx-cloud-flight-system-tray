name: Release
on: workflow_dispatch

jobs:
  release-x86:
    runs-on: macos-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Set up JDK
        uses: actions/setup-java@v3
        with:
          java-version: 17
          distribution: temurin
          cache: maven

      - name: Initialize Maven
        run: mvn -B initialize

      - name: jlink
        run: jlink --add-modules java.base,java.logging,java.desktop --output jre

      - name: Bundle
        env:
          JRE_PATH: jre
          BUNDLE_ARCHITECTURE: X86_64
        run: mvn -B -P bundle clean package

  release-arm:
    runs-on: macos-latest-xlarge

    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Set up JDK
        uses: actions/setup-java@v3
        with:
          java-version: 17
          distribution: temurin
          cache: maven

      - name: Initialize Maven
        run: mvn -B initialize

      - name: jlink
        run: jlink --add-modules java.base,java.logging,java.desktop --output jre

      - name: Bundle
        env:
          JRE_PATH: jre
          BUNDLE_ARCHITECTURE: ARM_64
        run: mvn -B -P bundle clean package
